H_mag[0,0] = 2*(Be*d-Bd*c+a*Bn);
H_mag[0,1] = 2*(Bd*d+Be*c+b*Bn);
H_mag[0,2] = -2*(Bn*c-b*Be+a*Bd);
H_mag[0,3] = -2*(Bn*d-a*Be-b*Bd);
H_mag[0,4] = 0;
H_mag[0,5] = 0;
H_mag[0,6] = 0;
H_mag[0,7] = 0;
H_mag[0,8] = 0;
H_mag[0,9] = 0;
H_mag[1,0] = -2*(Bn*d-a*Be-b*Bd);
H_mag[1,1] = 2*(Bn*c-b*Be+a*Bd);
H_mag[1,2] = 2*(Bd*d-Be*c+b*Bn);
H_mag[1,3] = -2*(Be*d-Bd*c+a*Bn);
H_mag[1,4] = 0;
H_mag[1,5] = 0;
H_mag[1,6] = 0;
H_mag[1,7] = 0;
H_mag[1,8] = 0;
H_mag[1,9] = 0;
H_mag[2,0] = 2*(Bn*c-b*Be+a*Bd);
H_mag[2,1] = 2*(Bn*d-a*Be-b*Bd);
H_mag[2,2] = 2*(Be*d-Bd*c+a*Bn);
H_mag[2,3] = 2*(Bd*d+Be*c+b*Bn);
H_mag[2,4] = 0;
H_mag[2,5] = 0;
H_mag[2,6] = 0;
H_mag[2,7] = 0;
H_mag[2,8] = 0;
H_mag[2,9] = 0;
