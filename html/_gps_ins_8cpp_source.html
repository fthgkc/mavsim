<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mavsim: /hsl/homes/jgoppert/Projects/mavsim/src/math/GpsIns.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/hsl/homes/jgoppert/Projects/mavsim/src/math/GpsIns.cpp</h1>  </div>
</div>
<div class="contents">
<a href="_gps_ins_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * GpsIns.cpp</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright (C) Brandon Wampler &lt;brandon.wampler@gmail.com&gt;</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * GpsIns.cpp is free software: you can redistribute it and/or modify it</span>
<a name="l00006"></a>00006 <span class="comment"> * under the terms of the GNU General Public License as published by the</span>
<a name="l00007"></a>00007 <span class="comment"> * Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment"> * (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * GpsIns.cpp is distributed in the hope that it will be useful, but</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<a name="l00013"></a>00013 <span class="comment"> * See the GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> * You should have received a copy of the GNU General Public License along</span>
<a name="l00016"></a>00016 <span class="comment"> * with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="_gps_ins_8hpp.html">GpsIns.hpp</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;boost/numeric/ublas/matrix_proxy.hpp&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;boost/numeric/ublas/vector_proxy.hpp&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="math_2utilities_8hpp.html">utilities.hpp</a>&quot;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a7072e63bfe0c3f98f199d14cf4858e01">00023</a> <span class="keyword">namespace </span>mavsim
<a name="l00024"></a>00024 {
<a name="l00025"></a>00025 <a class="code" href="classmavsim_1_1_gps_ins.html#a7072e63bfe0c3f98f199d14cf4858e01">GpsIns::GpsIns</a>(<span class="keywordtype">double</span> lat, <span class="keywordtype">double</span> lon, <span class="keywordtype">double</span> height, <span class="comment">//</span>
<a name="l00026"></a>00026                 <span class="keywordtype">double</span> roll, <span class="keywordtype">double</span> pitch, <span class="keywordtype">double</span> yaw, <span class="comment">//</span>
<a name="l00027"></a>00027                 <span class="keywordtype">double</span> Vn, <span class="keywordtype">double</span> Ve, <span class="keywordtype">double</span> Vd, <span class="comment">//</span>
<a name="l00028"></a>00028                 <span class="keywordtype">double</span> sigmaPos, <span class="keywordtype">double</span> sigmaAlt, <span class="keywordtype">double</span> sigmaVel, <span class="comment">//</span>
<a name="l00029"></a>00029                 <span class="keywordtype">double</span> sigmaAccelG, <span class="keywordtype">double</span> sigmaGyro, <span class="keywordtype">bool</span> useGravity): <span class="comment">//</span>
<a name="l00030"></a>00030                 sigmaDegLat(sigmaPos/111131.745*M_PI/180.0), sigmaH(sigmaAlt), sigmaV(sigmaVel), sigmaAccel(sigmaAccelG*g0), sigmaGyro(sigmaGyro)
<a name="l00031"></a>00031 {
<a name="l00032"></a>00032     <span class="comment">//sigmaDegLat = sigmaPos/111131.745*M_PI/180.0; //10 meters expressed as radians of latitude uncertainty</span>
<a name="l00033"></a>00033     <span class="comment">//sigmaAccel = .01*g0; //1 milli g accell uncertainty</span>
<a name="l00034"></a>00034     <span class="comment">//sigmaGyro = 2*M_PI/180; //1 deg/sec rate uncertainty</span>
<a name="l00035"></a>00035     <span class="comment">//sigmaH = 10; //meters</span>
<a name="l00036"></a>00036     <span class="comment">//sigmaV = 0.2; //meters/sec</span>
<a name="l00037"></a>00037     sigmaDeg = .001*M_PI/180; <span class="comment">//1 deg attitude uncertainty</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039     jFreq = 500;
<a name="l00040"></a>00040     kFreq = 100;
<a name="l00041"></a>00041     lFreq = 10;
<a name="l00042"></a>00042     gFreq = 1;
<a name="l00043"></a>00043     integrateIndex=0;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     dt_j = dt_k = dt_l = dt_g = 0;
<a name="l00046"></a>00046     kQuat = 1;
<a name="l00047"></a>00047     g = zero_vector&lt;double&gt;(3);
<a name="l00048"></a>00048     <span class="keywordflow">if</span>(useGravity) g(2) = g0;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050     v = zero_vector&lt;double&gt;(3);
<a name="l00051"></a>00051     sigma = zero_vector&lt;double&gt;(3);
<a name="l00052"></a>00052     alfa = zero_vector&lt;double&gt;(3);
<a name="l00053"></a>00053     deltaAlfa = zero_vector&lt;double&gt;(3);
<a name="l00054"></a>00054     zeta = zero_vector&lt;double&gt;(3);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     q = zero_vector&lt;double&gt;(4);
<a name="l00057"></a>00057     vn(0) = Vn;
<a name="l00058"></a>00058         vn(1) = Ve;
<a name="l00059"></a>00059         vn(2) = Vd;
<a name="l00060"></a>00060     vnk = zero_vector&lt;double&gt;(3);
<a name="l00061"></a>00061     vnkMinus = zero_vector&lt;double&gt;(3);
<a name="l00062"></a>00062     r = zero_vector&lt;double&gt;(4);
<a name="l00063"></a>00063     p = zero_vector&lt;double&gt;(4);
<a name="l00064"></a>00064     un = zero_vector&lt;double&gt;(3);
<a name="l00065"></a>00065     unCrossIntegral = zero_vector&lt;double&gt;(3);
<a name="l00066"></a>00066     xn = zero_vector&lt;double&gt;(3);
<a name="l00067"></a>00067     xnk = zero_vector&lt;double&gt;(3);
<a name="l00068"></a>00068     xnkMinus = zero_vector&lt;double&gt;(3);
<a name="l00069"></a>00069     w_en = w_ie = zero_vector&lt;double&gt;(3);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     eulerAtt(0) = roll;
<a name="l00072"></a>00072     eulerAtt(1) = pitch;
<a name="l00073"></a>00073     eulerAtt(2) = yaw;
<a name="l00074"></a>00074     q = <a class="code" href="namespacemavsim.html#ae441ad7afbf0158afba3e2225821e213">euler2Quat</a>(eulerAtt);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076     latLonH(0) = lat;
<a name="l00077"></a>00077     latLonH(1) = lon;
<a name="l00078"></a>00078     latLonH(2) = height;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     qLatLon = <a class="code" href="namespacemavsim.html#a0dc9d6c068db9bc7d0d9744fcbc5fe64">latLon2Quat</a>(lat, lon);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="comment">//GPS-INS filter variables</span>
<a name="l00083"></a>00083     Sigma = zero_vector&lt;double&gt;(3); <span class="comment">//incremental sum of body rotation</span>
<a name="l00084"></a>00084     Un = zero_vector&lt;double&gt;(3); <span class="comment">//incremental sum of change in velocity</span>
<a name="l00085"></a>00085     Zeta = zero_vector&lt;double&gt;(3); <span class="comment">//incremental sum of navigation frame rotation</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     H = zero_matrix&lt;double&gt;(6,9);
<a name="l00088"></a>00088     Fc = zero_matrix&lt;double&gt;(9,9);
<a name="l00089"></a>00089     Fd = zero_matrix&lt;double&gt;(9,9);
<a name="l00090"></a>00090     Frr = Frv = Fvr = Fvv = zero_matrix&lt;double&gt;(3,3);
<a name="l00091"></a>00091     Fqr = zero_matrix&lt;double&gt;(3,3);
<a name="l00092"></a>00092     Fqv = zero_matrix&lt;double&gt;(3,3);
<a name="l00093"></a>00093     fnX = zero_matrix&lt;double&gt;(3,3);
<a name="l00094"></a>00094     w_inX = zero_matrix&lt;double&gt;(3,3);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <span class="comment">//Noise Matrices</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <a class="code" href="ins__error__dynamics___g_8hpp.html#a85ee963871cdba55dd9b892f71c31a6b">G</a> = zero_matrix&lt;double&gt;(9,6);
<a name="l00099"></a>00099     Q = zero_matrix&lt;double&gt;(6,6);
<a name="l00100"></a>00100     Qk = zero_matrix&lt;double&gt;(9,9);
<a name="l00101"></a>00101     Rk = zero_matrix&lt;double&gt;(6,6);
<a name="l00102"></a>00102     subrange(Q, 0,3, 0,3) = sigmaAccel*sigmaAccel*identity_matrix&lt;double&gt;(3);<span class="comment">//accel noise</span>
<a name="l00103"></a>00103     subrange(Q, 3,6, 3,6) = sigmaGyro*sigmaGyro*identity_matrix&lt;double&gt;(3);<span class="comment">//qyro noise</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     P = zero_matrix&lt;double&gt;(9,9);
<a name="l00106"></a>00106     P(0,0) = R0*R0*sigmaDegLat*sigmaDegLat;
<a name="l00107"></a>00107     P(1,1) = R0*R0*sigmaDegLat*sigmaDegLat*cos(latLonH(0))*cos(latLonH(0));
<a name="l00108"></a>00108     P(2,2) = sigmaH*sigmaH;
<a name="l00109"></a>00109     P(3,3) = sigmaV*sigmaV;
<a name="l00110"></a>00110     P(4,4) = sigmaV*sigmaV;
<a name="l00111"></a>00111     P(5,5) = sigmaV*sigmaV;
<a name="l00112"></a>00112     P(6,6) = sigmaDeg*sigmaDeg;
<a name="l00113"></a>00113     P(7,7) = sigmaDeg*sigmaDeg;
<a name="l00114"></a>00114     P(8,8) = sigmaDeg*sigmaDeg;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="comment">//Time</span>
<a name="l00117"></a>00117     time = time_j = time_k = time_l= time_g = time_0 = boost::posix_time::microsec_clock::universal_time();
<a name="l00118"></a>00118     elapsed=0;
<a name="l00119"></a>00119     I3 = identity_matrix&lt;double&gt;(3);
<a name="l00120"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a55bfa4489715f0c2f6059bf7e0a5dba5">00120</a> }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a55bfa4489715f0c2f6059bf7e0a5dba5">GpsIns::updateAll</a>(<span class="keywordtype">double</span> fbx, <span class="keywordtype">double</span> fby, <span class="keywordtype">double</span> fbz, <span class="keywordtype">double</span> wbx, <span class="keywordtype">double</span> wby, <span class="keywordtype">double</span> wbz, <span class="keywordtype">double</span> lat, <span class="keywordtype">double</span> lon, <span class="keywordtype">double</span> alt, <span class="keywordtype">double</span> Vn, <span class="keywordtype">double</span> Ve, <span class="keywordtype">double</span> Vd)
<a name="l00123"></a>00123 {
<a name="l00124"></a>00124         vector&lt;double&gt; fb(3), wb(3), z(6);
<a name="l00125"></a>00125         fb(0) = fbx;
<a name="l00126"></a>00126         fb(1) = fby;
<a name="l00127"></a>00127         fb(2) = fbz;
<a name="l00128"></a>00128         wb(0) = wbx;
<a name="l00129"></a>00129         wb(1) = wby;
<a name="l00130"></a>00130         wb(2) = wbz;
<a name="l00131"></a>00131         z(0) = lat;
<a name="l00132"></a>00132         z(1) = lon;
<a name="l00133"></a>00133         z(2) = alt;
<a name="l00134"></a>00134         z(3) = Vn;
<a name="l00135"></a>00135         z(4) = Ve;
<a name="l00136"></a>00136         z(5) = Vd;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <a class="code" href="classmavsim_1_1_gps_ins.html#a6bc45d77f089e14b4745674ae7ca0b58">updateFast</a>(fb,wb);
<a name="l00139"></a>00139         <a class="code" href="classmavsim_1_1_gps_ins.html#a685735838afb4e5d9fe6a2e1f8b72030">updateMed</a>();
<a name="l00140"></a>00140         <a class="code" href="classmavsim_1_1_gps_ins.html#a0b3be65117431e24c59a7cb208c43ac5">updateSlow</a>();
<a name="l00141"></a>00141         <a class="code" href="classmavsim_1_1_gps_ins.html#ae833be03356210e77d75c1815734300f">updateGps</a>(z);
<a name="l00142"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a6bc45d77f089e14b4745674ae7ca0b58">00142</a> }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a6bc45d77f089e14b4745674ae7ca0b58">GpsIns::updateFast</a>(<span class="keyword">const</span> ublas::vector&lt;double&gt; &amp;fb, <span class="keyword">const</span> ublas::vector&lt;double&gt; &amp;wbIn)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146     <span class="comment">//calculate elapsed time for each cycle</span>
<a name="l00147"></a>00147     <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a> = boost::posix_time::microsec_clock::universal_time();
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <a class="code" href="classmavsim_1_1_gps_ins.html#a075d976677a30f06ece710b575db4e9b">diff_j</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>-<a class="code" href="classmavsim_1_1_gps_ins.html#a5d3f7742b55454b6212aff55bf2998a7">time_j</a>;
<a name="l00150"></a>00150     <a class="code" href="classmavsim_1_1_gps_ins.html#a5c3bc96eafe5b5f7505e03d1da5c93af">dt_j</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a075d976677a30f06ece710b575db4e9b">diff_j</a>.total_microseconds()/1e6;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#a5c3bc96eafe5b5f7505e03d1da5c93af">dt_j</a> &gt;= 1.0/<a class="code" href="classmavsim_1_1_gps_ins.html#a2607275ab4e650ef62d59ba4580e40c8">jFreq</a>)
<a name="l00153"></a>00153     {
<a name="l00154"></a>00154         time_j=<a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>;
<a name="l00155"></a>00155                 
<a name="l00156"></a>00156                 bounded_vector&lt;double,3&gt; wb;
<a name="l00157"></a>00157                 wb = wbIn ;<span class="comment">//+ quatRotate(q,w_ie);</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a> += wb*<a class="code" href="classmavsim_1_1_gps_ins.html#a5c3bc96eafe5b5f7505e03d1da5c93af">dt_j</a>;
<a name="l00160"></a>00160         <a class="code" href="classmavsim_1_1_gps_ins.html#a0fb6ad641a23d4a5c2aa1117d3732723">deltaAlfa</a>+=<a class="code" href="namespacemavsim.html#afb83bb3ccc20b9ac8ab0d73a593bfd1d">crossProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a>,wb)*dt_j;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         <a class="code" href="classmavsim_1_1_gps_ins.html#af556433d8241f2b69fa44b3928469aad">v</a>+=fb*dt_j;
<a name="l00163"></a>00163         <a class="code" href="classmavsim_1_1_gps_ins.html#a601f700e9e4548fe0d793fe2a8f5f69b">unCrossIntegral</a>+=(<a class="code" href="namespacemavsim.html#afb83bb3ccc20b9ac8ab0d73a593bfd1d">crossProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a>,fb)-<a class="code" href="namespacemavsim.html#afb83bb3ccc20b9ac8ab0d73a593bfd1d">crossProd</a>(wb,<a class="code" href="classmavsim_1_1_gps_ins.html#af556433d8241f2b69fa44b3928469aad">v</a>))*dt_j;
<a name="l00164"></a>00164         <span class="comment">//std::cout&lt;&lt;&quot;j-cycle Hz: &quot;&lt;&lt;1.0/dt_j&lt;&lt;std::endl;</span>
<a name="l00165"></a>00165     }
<a name="l00166"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a685735838afb4e5d9fe6a2e1f8b72030">00166</a> }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a685735838afb4e5d9fe6a2e1f8b72030">GpsIns::updateMed</a>()
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170     <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a> = boost::posix_time::microsec_clock::universal_time();
<a name="l00171"></a>00171     <a class="code" href="classmavsim_1_1_gps_ins.html#a9c62efea08f4218db3aead246bd89316">diff_k</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>-<a class="code" href="classmavsim_1_1_gps_ins.html#a8a32b3b7cd86954c742207a73a26b5ad">time_k</a>;
<a name="l00172"></a>00172     <a class="code" href="classmavsim_1_1_gps_ins.html#a221e423c8bdadded036d992ae56e7bd1">dt_k</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a9c62efea08f4218db3aead246bd89316">diff_k</a>.total_microseconds()/1e6;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#a221e423c8bdadded036d992ae56e7bd1">dt_k</a>&gt;=1.0/<a class="code" href="classmavsim_1_1_gps_ins.html#a8b12275e842d7a63bf7397cac30a3c80">kFreq</a>)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2);
<a name="l00177"></a>00177         time_k=<a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>;
<a name="l00178"></a>00178         <a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#a0fb6ad641a23d4a5c2aa1117d3732723">deltaAlfa</a>;
<a name="l00179"></a>00179         <a class="code" href="classmavsim_1_1_gps_ins.html#a6594ba597958caec6b458aaf75001dc0">Sigma</a> += <a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a>;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181         <a class="code" href="classmavsim_1_1_gps_ins.html#ac2484f5d69dc8cc1ab642dc66f2e5881">sigmaNorm</a> = norm_2(<a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a>);
<a name="l00182"></a>00182         <a class="code" href="classmavsim_1_1_gps_ins.html#a09c2eeb18e53b8918a2e97641c5bf4fb">ac</a>=cos(<a class="code" href="classmavsim_1_1_gps_ins.html#ac2484f5d69dc8cc1ab642dc66f2e5881">sigmaNorm</a>/2.0);
<a name="l00183"></a>00183         <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#ac2484f5d69dc8cc1ab642dc66f2e5881">sigmaNorm</a>&lt;1e-100) <a class="code" href="classmavsim_1_1_gps_ins.html#a9dd0272f5ca8e93042ceab6b1a6b4169">as</a> = 0;
<a name="l00184"></a>00184         <span class="keywordflow">else</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a9dd0272f5ca8e93042ceab6b1a6b4169">as</a>=sin(<a class="code" href="classmavsim_1_1_gps_ins.html#ac2484f5d69dc8cc1ab642dc66f2e5881">sigmaNorm</a>/2.0)/<a class="code" href="classmavsim_1_1_gps_ins.html#ac2484f5d69dc8cc1ab642dc66f2e5881">sigmaNorm</a>;
<a name="l00185"></a>00185         <a class="code" href="classmavsim_1_1_gps_ins.html#aabd1514d2abe3111bf377500d7d2d821">r</a>(0)=<a class="code" href="classmavsim_1_1_gps_ins.html#a09c2eeb18e53b8918a2e97641c5bf4fb">ac</a>;
<a name="l00186"></a>00186         <a class="code" href="classmavsim_1_1_gps_ins.html#aabd1514d2abe3111bf377500d7d2d821">r</a>(1)=<a class="code" href="classmavsim_1_1_gps_ins.html#a9dd0272f5ca8e93042ceab6b1a6b4169">as</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a>(0);
<a name="l00187"></a>00187         <a class="code" href="classmavsim_1_1_gps_ins.html#aabd1514d2abe3111bf377500d7d2d821">r</a>(2)=<a class="code" href="classmavsim_1_1_gps_ins.html#a9dd0272f5ca8e93042ceab6b1a6b4169">as</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a>(1);
<a name="l00188"></a>00188         <a class="code" href="classmavsim_1_1_gps_ins.html#aabd1514d2abe3111bf377500d7d2d821">r</a>(3)=<a class="code" href="classmavsim_1_1_gps_ins.html#a9dd0272f5ca8e93042ceab6b1a6b4169">as</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#ace7b34b27255c1035a88f8d0434c0d3a">sigma</a>(2);
<a name="l00189"></a>00189         <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a> = <a class="code" href="namespacemavsim.html#a589848419800ad70f4f8da647ec58ed6">quatProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#aabd1514d2abe3111bf377500d7d2d821">r</a>);
<a name="l00190"></a>00190         <span class="comment">//q+=q*kQuat*(1-(q(0)*q(0) + q(1)*q(1) + q(2)*q(2) + q(3)*q(3)));</span>
<a name="l00191"></a>00191         <span class="comment">//std::cout&lt;&lt;&quot;Euler: &quot;&lt;&lt;quat2Euler(q)*180/M_PI&lt;&lt;std::endl;</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193         <a class="code" href="classmavsim_1_1_gps_ins.html#aed299484b5d904e92db12b908de662cc">un</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#af556433d8241f2b69fa44b3928469aad">v</a> + 0.5*<a class="code" href="namespacemavsim.html#afb83bb3ccc20b9ac8ab0d73a593bfd1d">crossProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#af556433d8241f2b69fa44b3928469aad">v</a>) + 0.5*<a class="code" href="classmavsim_1_1_gps_ins.html#a601f700e9e4548fe0d793fe2a8f5f69b">unCrossIntegral</a>;
<a name="l00194"></a>00194         <a class="code" href="classmavsim_1_1_gps_ins.html#aed299484b5d904e92db12b908de662cc">un</a> = <a class="code" href="namespacemavsim.html#a5a03e4171ec2b49945599fd39f688525">quatRotate</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#aed299484b5d904e92db12b908de662cc">un</a>);
<a name="l00195"></a>00195         <a class="code" href="classmavsim_1_1_gps_ins.html#aef7d46b14c8a101cadb000035ed1e0ee">Un</a> += <a class="code" href="classmavsim_1_1_gps_ins.html#aed299484b5d904e92db12b908de662cc">un</a>;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <a class="code" href="classmavsim_1_1_gps_ins.html#a2e76d1f942687c8e04623d534578b7f6">xnkMinus</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ab77eb85def3147687774df21752658e4">xnk</a>;
<a name="l00198"></a>00198         <a class="code" href="classmavsim_1_1_gps_ins.html#ab77eb85def3147687774df21752658e4">xnk</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a130b5682360faa5479c18b3f6ade4702">xn</a>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <a class="code" href="classmavsim_1_1_gps_ins.html#ad1f87d5663472cf2d4deb3c7a0411d45">vnkMinus</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a64f419dd9c0b869556f80d40dd5d5eeb">vnk</a>;
<a name="l00201"></a>00201         <a class="code" href="classmavsim_1_1_gps_ins.html#a64f419dd9c0b869556f80d40dd5d5eeb">vnk</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>;
<a name="l00202"></a>00202         <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a> += <a class="code" href="classmavsim_1_1_gps_ins.html#aed299484b5d904e92db12b908de662cc">un</a> + <a class="code" href="classmavsim_1_1_gps_ins.html#a403f05fda713f43e059ee8acf4233c24">g</a>*(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>))*(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>))*<a class="code" href="classmavsim_1_1_gps_ins.html#a221e423c8bdadded036d992ae56e7bd1">dt_k</a>;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#ab4799c9ff539a7291485c86bfd6fb850">integrateIndex</a> == 2)
<a name="l00205"></a>00205         {
<a name="l00206"></a>00206             <a class="code" href="classmavsim_1_1_gps_ins.html#a130b5682360faa5479c18b3f6ade4702">xn</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a2e76d1f942687c8e04623d534578b7f6">xnkMinus</a> + ((<a class="code" href="classmavsim_1_1_gps_ins.html#ad1f87d5663472cf2d4deb3c7a0411d45">vnkMinus</a> + 4*<a class="code" href="classmavsim_1_1_gps_ins.html#a64f419dd9c0b869556f80d40dd5d5eeb">vnk</a> + <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>)/3.0)*dt_k;
<a name="l00207"></a>00207             <span class="comment">//std::cout&lt;&lt;&quot;vnkMinus: &quot;&lt;&lt;vnkMinus&lt;&lt;std::endl;</span>
<a name="l00208"></a>00208             <span class="comment">//std::cout&lt;&lt;&quot;vnk: &quot;&lt;&lt;vnk&lt;&lt;std::endl;</span>
<a name="l00209"></a>00209             <span class="comment">//std::cout&lt;&lt;&quot;vn: &quot;&lt;&lt;vn&lt;&lt;std::endl;</span>
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#ab4799c9ff539a7291485c86bfd6fb850">integrateIndex</a> == 1) <a class="code" href="classmavsim_1_1_gps_ins.html#a130b5682360faa5479c18b3f6ade4702">xn</a>+= ((<a class="code" href="classmavsim_1_1_gps_ins.html#a64f419dd9c0b869556f80d40dd5d5eeb">vnk</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>)/2.0)*dt_k, <a class="code" href="classmavsim_1_1_gps_ins.html#ab4799c9ff539a7291485c86bfd6fb850">integrateIndex</a>++;
<a name="l00212"></a>00212         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integrateIndex == 0) <a class="code" href="classmavsim_1_1_gps_ins.html#a130b5682360faa5479c18b3f6ade4702">xn</a>+= <a class="code" href="classmavsim_1_1_gps_ins.html#a64f419dd9c0b869556f80d40dd5d5eeb">vnk</a>*dt_k, integrateIndex++;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214         <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0) += <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(0)*dt_k/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>);
<a name="l00215"></a>00215         <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(1) += <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(1)*dt_k/(cos(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0))*(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>));
<a name="l00216"></a>00216         <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2) += -<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(2)*dt_k;
<a name="l00217"></a>00217         <a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219         <a class="code" href="classmavsim_1_1_gps_ins.html#abdc17bee87e80a738d50bf39f1d1be5d">w_en</a>(0) = <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(1)/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>);
<a name="l00220"></a>00220         <a class="code" href="classmavsim_1_1_gps_ins.html#abdc17bee87e80a738d50bf39f1d1be5d">w_en</a>(1) = -<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(0)/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>);
<a name="l00221"></a>00221         <a class="code" href="classmavsim_1_1_gps_ins.html#abdc17bee87e80a738d50bf39f1d1be5d">w_en</a>(2) = -<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(1)*tan(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0))/(<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#addd8517650c0e4e966170c8d607593b8">h</a>);
<a name="l00222"></a>00222         <a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>+=<a class="code" href="classmavsim_1_1_gps_ins.html#abdc17bee87e80a738d50bf39f1d1be5d">w_en</a>*dt_k;
<a name="l00223"></a>00223         <a class="code" href="classmavsim_1_1_gps_ins.html#a9bf1308f01980acd2fa16af65eaa7994">Zeta</a>+=<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>;
<a name="l00224"></a>00224         <span class="comment">//reset integrating terms</span>
<a name="l00225"></a>00225         <a class="code" href="classmavsim_1_1_gps_ins.html#a812124d0695a0c8daeaaac18fc06e561">alfa</a> = deltaAlfa = <a class="code" href="classmavsim_1_1_gps_ins.html#af556433d8241f2b69fa44b3928469aad">v</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a601f700e9e4548fe0d793fe2a8f5f69b">unCrossIntegral</a> = zero_vector&lt;double&gt;(3);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         <span class="comment">//std::cout&lt;&lt;&quot;k-cycle Hz: &quot;&lt;&lt;1.0/dt_k&lt;&lt;std::endl;</span>
<a name="l00228"></a>00228     }
<a name="l00229"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a0b3be65117431e24c59a7cb208c43ac5">00229</a> }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a0b3be65117431e24c59a7cb208c43ac5">GpsIns::updateSlow</a>()
<a name="l00232"></a>00232 {
<a name="l00233"></a>00233     <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a> = boost::posix_time::microsec_clock::universal_time();
<a name="l00234"></a>00234     <a class="code" href="classmavsim_1_1_gps_ins.html#a08629881d6c34ea4f2864da69f1857d6">diff_l</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>-<a class="code" href="classmavsim_1_1_gps_ins.html#a65f286ddc01325faef8818144e3d2c5c">time_l</a>;
<a name="l00235"></a>00235     <a class="code" href="classmavsim_1_1_gps_ins.html#a48413fc786fe5805524b16ddb961e4d7">dt_l</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a08629881d6c34ea4f2864da69f1857d6">diff_l</a>.total_microseconds()/1e6;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <span class="keywordflow">if</span>(<a class="code" href="classmavsim_1_1_gps_ins.html#a48413fc786fe5805524b16ddb961e4d7">dt_l</a>&gt;=1.0/<a class="code" href="classmavsim_1_1_gps_ins.html#a7cd1bb373b88afe27a7dec0c63b0164b">lFreq</a>)
<a name="l00238"></a>00238     {
<a name="l00239"></a>00239         time_l=<a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>;
<a name="l00240"></a>00240         <a class="code" href="classmavsim_1_1_gps_ins.html#aaf455e1e37fc4315e0962a7c5141201a">diff_0</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a> - <a class="code" href="classmavsim_1_1_gps_ins.html#aa803dc78bb647d4497571b60ed6a8947">time_0</a>;
<a name="l00241"></a>00241         <a class="code" href="classmavsim_1_1_gps_ins.html#a04588f24cc4002a63299213859db8fa5">elapsed</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#aaf455e1e37fc4315e0962a7c5141201a">diff_0</a>.total_microseconds()/1e6;
<a name="l00242"></a>00242         <span class="comment">//std::cout&lt;&lt;&quot;Elapsed: &quot;&lt;&lt;elapsed&lt;&lt;std::endl;</span>
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         <span class="comment">//coriolis correction</span>
<a name="l00245"></a>00245         <a class="code" href="classmavsim_1_1_gps_ins.html#a99d52b78b30d07fe834253c126994f9f">w_ie</a>(0) = <a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*cos(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0));
<a name="l00246"></a>00246         <a class="code" href="classmavsim_1_1_gps_ins.html#a99d52b78b30d07fe834253c126994f9f">w_ie</a>(1) = 0;
<a name="l00247"></a>00247         <a class="code" href="classmavsim_1_1_gps_ins.html#a99d52b78b30d07fe834253c126994f9f">w_ie</a>(2) = <a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*sin(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0));
<a name="l00248"></a>00248 
<a name="l00249"></a>00249         <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a> =  <a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>((<a class="code" href="classmavsim_1_1_gps_ins.html#aabda3480d5e1fdeaef3a29c6416d45d4">I3</a> - 2.0*<a class="code" href="namespacemavsim.html#adadc49963862cdf0411bdb30f07417a6">cross</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a99d52b78b30d07fe834253c126994f9f">w_ie</a>)*<a class="code" href="classmavsim_1_1_gps_ins.html#a48413fc786fe5805524b16ddb961e4d7">dt_l</a> - <a class="code" href="namespacemavsim.html#adadc49963862cdf0411bdb30f07417a6">cross</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>)),<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251         <span class="comment">//rotating navigation frame correction</span>
<a name="l00252"></a>00252         <a class="code" href="classmavsim_1_1_gps_ins.html#aa3dc316b61c68732c700868d166b21c0">zetaNorm</a> = norm_2(<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>);
<a name="l00253"></a>00253         <a class="code" href="classmavsim_1_1_gps_ins.html#aeda89cfbf9fb8b78724e01f2b56db728">bc</a>=cos(<a class="code" href="classmavsim_1_1_gps_ins.html#aa3dc316b61c68732c700868d166b21c0">zetaNorm</a>/2.0);
<a name="l00254"></a>00254         <span class="keywordflow">if</span> (<a class="code" href="classmavsim_1_1_gps_ins.html#aa3dc316b61c68732c700868d166b21c0">zetaNorm</a>&lt;1e-100) <a class="code" href="classmavsim_1_1_gps_ins.html#afa0c0ebfcdb79ed381481fa73e2701e1">bs</a> = 0;
<a name="l00255"></a>00255         <span class="keywordflow">else</span> <a class="code" href="classmavsim_1_1_gps_ins.html#afa0c0ebfcdb79ed381481fa73e2701e1">bs</a>=sin(<a class="code" href="classmavsim_1_1_gps_ins.html#aa3dc316b61c68732c700868d166b21c0">zetaNorm</a>/2.0)/<a class="code" href="classmavsim_1_1_gps_ins.html#aa3dc316b61c68732c700868d166b21c0">zetaNorm</a>;
<a name="l00256"></a>00256         <a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>(0)=<a class="code" href="classmavsim_1_1_gps_ins.html#aeda89cfbf9fb8b78724e01f2b56db728">bc</a>;
<a name="l00257"></a>00257         <a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>(1)=<a class="code" href="classmavsim_1_1_gps_ins.html#afa0c0ebfcdb79ed381481fa73e2701e1">bs</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>(0);
<a name="l00258"></a>00258         <a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>(2)=<a class="code" href="classmavsim_1_1_gps_ins.html#afa0c0ebfcdb79ed381481fa73e2701e1">bs</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>(1);
<a name="l00259"></a>00259         <a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>(3)=<a class="code" href="classmavsim_1_1_gps_ins.html#afa0c0ebfcdb79ed381481fa73e2701e1">bs</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c726e48fd532e5a36e36738b34622be">zeta</a>(2);
<a name="l00260"></a>00260         <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a> = <a class="code" href="namespacemavsim.html#a589848419800ad70f4f8da647ec58ed6">quatProd</a>(<a class="code" href="namespacemavsim.html#aa8c4ccb0d961d17c9d0241cc745c4fd9">quatConj</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>),<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>);
<a name="l00261"></a>00261         <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a> = <a class="code" href="namespacemavsim.html#a589848419800ad70f4f8da647ec58ed6">quatProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#acfebc4769330bd17694ba53798d7fe13">p</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="comment">//std::cout&lt;&lt;&quot;P Euler: &quot;&lt;&lt;quat2Euler(p)&lt;&lt;std::endl;</span>
<a name="l00264"></a>00264         <span class="comment">//std::cout&lt;&lt;&quot;P Quat: &quot;&lt;&lt;p&lt;&lt;std::endl;</span>
<a name="l00265"></a>00265         <span class="comment">//std::cout&lt;&lt;&quot;QLATLON: &quot;&lt;&lt;quat2Euler(qLatLon)*180/M_PI&lt;&lt;std::endl;</span>
<a name="l00266"></a>00266         <span class="comment">//std::cout&lt;&lt;&quot;Q LAT LON H: &quot;&lt;&lt;quat2LatLon(qLatLon)&lt;&lt;std::endl;</span>
<a name="l00267"></a>00267         <span class="comment">//std::cout&lt;&lt;&quot;LAT LON H: &quot;&lt;&lt;latLonH*180/M_PI&lt;&lt;&quot; &quot;&lt;&lt;h&lt;&lt;std::endl;</span>
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="comment">//quaternion normilatization</span>
<a name="l00270"></a>00270         <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>+=<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a8dc67c0ce00701d979c59a70d28e5508">kQuat</a>*(1-(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(0)*<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(0) + <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(1)*<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(1) + <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(2)*<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(2) + <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(3)*<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>(3)));
<a name="l00271"></a>00271         <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>+=<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>*kQuat*(1-(<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(0)*<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(0) + <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(1)*<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(1) + <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(2)*<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(2) + <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(3)*<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>(3)));
<a name="l00272"></a>00272         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>, 0,2) = <a class="code" href="namespacemavsim.html#a7341f17151a4dfc43e0f1aaa3fce1f35">quat2LatLon</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>);
<a name="l00273"></a>00273         <span class="comment">//std::cout&lt;&lt;&quot;l-cycle Hz: &quot;&lt;&lt;1.0/dt_l&lt;&lt;std::endl;</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <span class="comment">//std::cout&lt;&lt;&quot;Pos: &quot;&lt;&lt;xn&lt;&lt;std::endl;</span>
<a name="l00276"></a>00276         <span class="comment">//std::cout&lt;&lt;&quot;LAT LON H: &quot;&lt;&lt;latLonH(0)*180/M_PI&lt;&lt;&quot; &quot;&lt;&lt;latLonH(1)*180/M_PI&lt;&lt;&quot; &quot;&lt;&lt;latLonH(2)&lt;&lt;std::endl;</span>
<a name="l00277"></a>00277         <span class="comment">//std::cout&lt;&lt;&quot;Vel: &quot;&lt;&lt;vn&lt;&lt;std::endl;</span>
<a name="l00278"></a>00278         <span class="comment">//std::cout&lt;&lt;&quot;Att: &quot;&lt;&lt;quat2Euler(q)*180/M_PI&lt;&lt;std::endl;</span>
<a name="l00279"></a>00279         <span class="comment">//std::cout&lt;&lt;std::endl;</span>
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <span class="comment">//reset integration term</span>
<a name="l00282"></a>00282         zeta = zero_vector&lt;double&gt;(3);
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#ae833be03356210e77d75c1815734300f">GpsIns::updateGps</a>(<span class="keyword">const</span> vector&lt;double&gt; &amp;z)
<a name="l00287"></a>00287 {
<a name="l00288"></a>00288     <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a> = boost::posix_time::microsec_clock::universal_time();
<a name="l00289"></a>00289     <a class="code" href="classmavsim_1_1_gps_ins.html#afcbda5e3a7db1c61b7fb9b126d908d81">diff_g</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>-<a class="code" href="classmavsim_1_1_gps_ins.html#aa410fcc13627186a56fd20619cdc4310">time_g</a>;
<a name="l00290"></a>00290     <a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#afcbda5e3a7db1c61b7fb9b126d908d81">diff_g</a>.total_microseconds()/1e6;
<a name="l00291"></a>00291     <span class="keywordflow">if</span>(<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a>&gt;=<a class="code" href="classmavsim_1_1_gps_ins.html#ac1adb6f12a9e8313dcd09b4194fc2600">gFreq</a>)
<a name="l00292"></a>00292     {
<a name="l00293"></a>00293         time_g=<a class="code" href="classmavsim_1_1_gps_ins.html#ad7339e14c8cf926af03c4822222d568b">time</a>;
<a name="l00294"></a>00294         <span class="keywordtype">double</span> cosLat = cos(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0));
<a name="l00295"></a>00295         <span class="keywordtype">double</span> tanLat = tan(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0));
<a name="l00296"></a>00296         <span class="keywordtype">double</span> sinLat = sin(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0));
<a name="l00297"></a>00297         <span class="keywordtype">double</span> R = <a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2);
<a name="l00298"></a>00298         <span class="keywordtype">double</span> vN = <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(0);
<a name="l00299"></a>00299         <span class="keywordtype">double</span> vE = <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(1);
<a name="l00300"></a>00300         <span class="keywordtype">double</span> vD = <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(2);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <span class="comment">//Fill out Fc and Fd</span>
<a name="l00303"></a>00303         <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(0,0)=0      ,<a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(0,1)=0     , <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(0,2)=-vN/(R*R);
<a name="l00304"></a>00304         <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(1,0)=vE*sinLat/(R*cosLat*cosLat)    , <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(1,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(1,2)= -vE/(R*R*cosLat*cosLat);
<a name="l00305"></a>00305         <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(2,0)=0      ,<a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(2,1)=0     , <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>(2,2)=0    ;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(0,0)=1.0/R  , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(0,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(0,2)= 0   ;
<a name="l00308"></a>00308         <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(1,0)=0      , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(1,1)= 1.0/(R*cosLat)      , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(1,2)=0    ;
<a name="l00309"></a>00309         <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(2,0)= 0     , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(2,1)= 0   , <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>(2,2)= -1  ;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(0,0)= -2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*vE*cosLat-vE*vE/(R*cosLat*cosLat)        , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(0,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(0,2)= -vN*vD/(R*R) + vE*vE*tanLat/(R*R);
<a name="l00312"></a>00312         <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(1,0)= -2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*(sinLat*vD-vN*cosLat) - vE*vN/(R*cosLat*cosLat)  , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(1,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(1,2)= -(vD*vE/(R*R) + vE*vN*tanLat/(R*R)) ;
<a name="l00313"></a>00313         <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(2,0)= 2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*vE*sinLat , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(2,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>(2,2)= vE*vE/(R*R) + vN*vN/(R*R) - 2*g0*((<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a725eae1e816b330d3865c65d54df9b32">R0</a>/(R*R))/(R))        ;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315         <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(0,0)=vD/R   , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(0,1)=-2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*sinLat-2*vE*tanLat/R    , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(0,2)=vN/R ;
<a name="l00316"></a>00316         <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(1,0)= -(-2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*sinLat-vE*tanLat/R) , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(1,1)= -(-vD/R-vN*tanLat/R)   , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(1,2)= -(-2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*cosLat-vE/R) ;
<a name="l00317"></a>00317         <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(2,0)= -2*vN/R       , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(2,1)= -2*<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*cosLat-2*vE/R  , <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>(2,2)= 0   ;
<a name="l00318"></a>00318         <span class="comment">//my derivation</span>
<a name="l00319"></a>00319         <span class="comment">//Fvr(0,0)= -2*w*vE*cosLat-vE*vE/(R*cosLat*cosLat)      , Fvr(0,1)=0    , Fvr(0,2)= -vN*vD/(R*R) + vE*vE*tanLat/(R*R);</span>
<a name="l00320"></a>00320         <span class="comment">//Fvr(1,0)= 2*w*(sinLat*vD-vN*cosLat) - vE*vN/(R*cosLat*cosLat) , Fvr(1,1)=0    , Fvr(1,2)= vD*vE/(R*R) + vE*vN*tanLat/(R*R)    ;</span>
<a name="l00321"></a>00321         <span class="comment">//Fvr(2,0)= 2*w*vE*sinLat       , Fvr(2,1)=0    , Fvr(2,2)= vE*vE/(R*R) + vN*vN/(R*R) - 2*g0*((R0*R0/(R*R))/(R))        ;</span>
<a name="l00322"></a>00322 
<a name="l00323"></a>00323         <span class="comment">//Fvv(0,0)=vD/R         , Fvv(0,1)=-2*w*sinLat-2*vE*tanLat/R    , Fvv(0,2)=vN/R ;</span>
<a name="l00324"></a>00324         <span class="comment">//Fvv(1,0)= -2*w*sinLat-vE*tanLat/R , Fvv(1,1)= -vD/R-vN*tanLat/R       , Fvv(1,2)= -2*w*cosLat-vE/R    ;</span>
<a name="l00325"></a>00325         <span class="comment">//Fvv(2,0)= -2*vN/R     , Fvv(2,1)= -2*w*cosLat-2*vE/R  , Fvv(2,2)= 0   ;</span>
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(0,0)=-<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*sinLat      , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(0,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(0,2)= -vE/(R*R)   ;
<a name="l00328"></a>00328         <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(1,0)=0      , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(1,1)= 1.0/(R*cosLat)      , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(1,2)= vN/(R*R)    ;
<a name="l00329"></a>00329         <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(2,0)= -<a class="code" href="classmavsim_1_1_gps_ins.html#a6c17a644af2b9f50845a7643f1750436">w</a>*cosLat-vE/(R*R*cosLat*cosLat)      , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(2,1)= 0   , <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>(2,2)= vE*tanLat/(R*R)     ;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(0,0)=0      , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(0,1)=1/R  , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(0,2)= 0   ;
<a name="l00332"></a>00332         <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(1,0)=0      , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(1,1)=0    , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(1,2)= 0   ;
<a name="l00333"></a>00333         <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(2,0)=0      , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(2,1)=-tanLat/R    , <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>(2,2)= 0 ;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335         <a class="code" href="classmavsim_1_1_gps_ins.html#a7a10625348e55d27af5a779e725b7194">fnX</a> = <a class="code" href="namespacemavsim.html#adadc49963862cdf0411bdb30f07417a6">cross</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#aef7d46b14c8a101cadb000035ed1e0ee">Un</a>/<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a>);
<a name="l00336"></a>00336         <a class="code" href="classmavsim_1_1_gps_ins.html#a4c85cce188afbd7df16550bd91518920">w_inX</a> = <a class="code" href="namespacemavsim.html#adadc49963862cdf0411bdb30f07417a6">cross</a>((<a class="code" href="classmavsim_1_1_gps_ins.html#a9bf1308f01980acd2fa16af65eaa7994">Zeta</a>+<a class="code" href="classmavsim_1_1_gps_ins.html#a6594ba597958caec6b458aaf75001dc0">Sigma</a>)/<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a>);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 0,3,  0,3) = <a class="code" href="classmavsim_1_1_gps_ins.html#a1d103227363021f2a9182399b1461f30">Frr</a>, subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 0,3,  3,6) = <a class="code" href="classmavsim_1_1_gps_ins.html#a47645669e67ab55cd664ff9131302889">Frv</a>;
<a name="l00339"></a>00339         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 3,6,  0,3) = <a class="code" href="classmavsim_1_1_gps_ins.html#af122178ee53db43304fa3f971cde776a">Fvr</a>, subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 3,6,  3,6) = <a class="code" href="classmavsim_1_1_gps_ins.html#a7a67fd2e7759ea4ef6756b957b5b4877">Fvv</a>, subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 3,6,  6,9) = <a class="code" href="classmavsim_1_1_gps_ins.html#a7a10625348e55d27af5a779e725b7194">fnX</a>;
<a name="l00340"></a>00340         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 6,9, 0,3) = <a class="code" href="classmavsim_1_1_gps_ins.html#ad3a876d4ea868edb7058c44843f97888">Fqr</a>, subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 6,9, 3,6) = <a class="code" href="classmavsim_1_1_gps_ins.html#a486e7d9d1d6f177bca35b12ab0b40842">Fqv</a>, subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>, 6,9, 6,9) = -<a class="code" href="classmavsim_1_1_gps_ins.html#a4c85cce188afbd7df16550bd91518920">w_inX</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a3be2d9c269868d1bf36c266d868490">Fd</a> = identity_matrix&lt;double&gt;(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>.size1(), <a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>.size2()) + <a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a> + 0.5*<a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#a945a55ec89c5bfcb0e51b2ac066d526a">Fc</a>*dt_g);
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         <span class="comment">//Fill out G and Rk</span>
<a name="l00345"></a>00345         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>, 3,6, 0,3) = <a class="code" href="namespacemavsim.html#a8ae6df787d9b41f559e7a587eba6fd64">quat2Dcm</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>);
<a name="l00346"></a>00346         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>, 6,9, 3,6) = -<a class="code" href="namespacemavsim.html#a8ae6df787d9b41f559e7a587eba6fd64">quat2Dcm</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>);
<a name="l00347"></a>00347         <a class="code" href="classmavsim_1_1_gps_ins.html#afaa1d43d25038ac2aea2a7ed5a4fa8ba">Qk</a> = 0.5*(<a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a6a3be2d9c269868d1bf36c266d868490">Fd</a>,<a class="code" href="namespacemavsim.html#a1f7b7a0987fd9e02df1c146edc919389">prod3</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#a5040944b8656401c8670b764f16377e1">Q</a>,trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>))) + <a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(<a class="code" href="namespacemavsim.html#a1f7b7a0987fd9e02df1c146edc919389">prod3</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#a5040944b8656401c8670b764f16377e1">Q</a>,trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a8d47ab575b1bfc790fab128042dfd64d">G</a>)),trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a6a3be2d9c269868d1bf36c266d868490">Fd</a>)))*<a class="code" href="classmavsim_1_1_gps_ins.html#ae20f7f3e565ade7736d85d96e4cceb07">dt_g</a>;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="comment">//Fill out measurement matrix and Qk</span>
<a name="l00350"></a>00350         <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(0,0) = R;
<a name="l00351"></a>00351         <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(1,1) = R*cosLat;
<a name="l00352"></a>00352         <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(2,2) = <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(3,3) = <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(4,4) = <a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>(5,5) = 1.0;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(0,0) = R*R*<a class="code" href="classmavsim_1_1_gps_ins.html#a31509e8cd7b262ce79861f4f717f5e7c">sigmaDeg</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a31509e8cd7b262ce79861f4f717f5e7c">sigmaDeg</a>;
<a name="l00355"></a>00355         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(1,1) = R*R*sigmaDeg*sigmaDeg*cosLat*cosLat;
<a name="l00356"></a>00356         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(2,2) = <a class="code" href="classmavsim_1_1_gps_ins.html#a61661bf45cb84570ea8d12b3188f3516">sigmaH</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a61661bf45cb84570ea8d12b3188f3516">sigmaH</a>;
<a name="l00357"></a>00357         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(3,3) = <a class="code" href="classmavsim_1_1_gps_ins.html#a131e47812bf2d9904cc6c290829618ed">sigmaV</a>*<a class="code" href="classmavsim_1_1_gps_ins.html#a131e47812bf2d9904cc6c290829618ed">sigmaV</a>;
<a name="l00358"></a>00358         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(4,4) = sigmaV*sigmaV;
<a name="l00359"></a>00359         <a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>(5,5) = sigmaV*sigmaV;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="comment">//Kalman Filter</span>
<a name="l00362"></a>00362         <span class="comment">//Predict Covariance</span>
<a name="l00363"></a>00363         <a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a> =<a class="code" href="namespacemavsim.html#a1f7b7a0987fd9e02df1c146edc919389">prod3</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a6a3be2d9c269868d1bf36c266d868490">Fd</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a>,trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a6a3be2d9c269868d1bf36c266d868490">Fd</a>))+<a class="code" href="classmavsim_1_1_gps_ins.html#afaa1d43d25038ac2aea2a7ed5a4fa8ba">Qk</a>;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         <span class="comment">//kalman gain</span>
<a name="l00366"></a>00366         <a class="code" href="classmavsim_1_1_gps_ins.html#a897024dbae64bcf0e9b07184864995ab">inverse</a> = <a class="code" href="namespacemavsim.html#a1f7b7a0987fd9e02df1c146edc919389">prod3</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a>,trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>))+<a class="code" href="classmavsim_1_1_gps_ins.html#a6a77691f40c2404263369be9f1a3690c">Rk</a>;
<a name="l00367"></a>00367         <a class="code" href="classmavsim_1_1_gps_ins.html#a897024dbae64bcf0e9b07184864995ab">inverse</a> = <a class="code" href="namespacemavsim.html#ad8166adee3f79daac9ab07b440471020">inv</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a897024dbae64bcf0e9b07184864995ab">inverse</a>); <span class="comment">// don&#39;t use pinv since it is square</span>
<a name="l00368"></a>00368         <a class="code" href="classmavsim_1_1_gps_ins.html#a2183cb6d0debbe7ed646cc8b329c79a1">kalman</a> = <a class="code" href="namespacemavsim.html#a1f7b7a0987fd9e02df1c146edc919389">prod3</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a>,trans(<a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>),<a class="code" href="classmavsim_1_1_gps_ins.html#a897024dbae64bcf0e9b07184864995ab">inverse</a>);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370         <span class="comment">//correct xErr and P</span>
<a name="l00371"></a>00371         <span class="comment">//TODO</span>
<a name="l00372"></a>00372         <a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a> = <a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a2183cb6d0debbe7ed646cc8b329c79a1">kalman</a>,z);
<a name="l00373"></a>00373         <a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a> =<a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(identity_matrix&lt;double&gt;(9)-<a class="code" href="namespacemavsim.html#a761e615d059422fe4d38e9b2a131af3a">prod</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a2183cb6d0debbe7ed646cc8b329c79a1">kalman</a>,<a class="code" href="classmavsim_1_1_gps_ins.html#a3d33788380cd8268703a93c20cf87281">H</a>) , <a class="code" href="classmavsim_1_1_gps_ins.html#ab5299bcbf81544ff7b43deba39262a9c">P</a>);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         <span class="comment">//std::cout&lt;&lt;&quot;xErr: &quot;&lt;&lt;xErr&lt;&lt;std::endl;</span>
<a name="l00376"></a>00376         <a class="code" href="classmavsim_1_1_gps_ins.html#a5bc21cf7644de116a2cee310b9b4a92d">qLatLonCorrection</a> = <a class="code" href="namespacemavsim.html#a0dc9d6c068db9bc7d0d9744fcbc5fe64">latLon2Quat</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a>(0), <a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a>(1));
<a name="l00377"></a>00377         <a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a> = <a class="code" href="namespacemavsim.html#a589848419800ad70f4f8da647ec58ed6">quatProd</a>(<a class="code" href="namespacemavsim.html#aa8c4ccb0d961d17c9d0241cc745c4fd9">quatConj</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5bc21cf7644de116a2cee310b9b4a92d">qLatLonCorrection</a>),<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>);
<a name="l00378"></a>00378         subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>, 0,2) = <a class="code" href="namespacemavsim.html#a7341f17151a4dfc43e0f1aaa3fce1f35">quat2LatLon</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a2d1ce8507ded4d232f0eb82092185f90">qLatLon</a>);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380         <a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2) -= <a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a>(2);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a> -= subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a>, 3,6);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384         <a class="code" href="classmavsim_1_1_gps_ins.html#add47f813f741b2284694f9d3249a247a">qCorrection</a> = <a class="code" href="namespacemavsim.html#ae441ad7afbf0158afba3e2225821e213">euler2Quat</a>(subrange(<a class="code" href="classmavsim_1_1_gps_ins.html#a03ccdc386394b034caa47b03f4a6091d">xErr</a>, 6,9));
<a name="l00385"></a>00385 
<a name="l00386"></a>00386         <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a> = <a class="code" href="namespacemavsim.html#a589848419800ad70f4f8da647ec58ed6">quatProd</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#add47f813f741b2284694f9d3249a247a">qCorrection</a>, <a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388         <a class="code" href="classmavsim_1_1_gps_ins.html#aef7d46b14c8a101cadb000035ed1e0ee">Un</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a6594ba597958caec6b458aaf75001dc0">Sigma</a> = <a class="code" href="classmavsim_1_1_gps_ins.html#a9bf1308f01980acd2fa16af65eaa7994">Zeta</a> = zero_vector&lt;double&gt;(3);
<a name="l00389"></a>00389                 <span class="comment">//std::cout&lt;&lt;&quot;Lat Lon H GpsUpdate: &quot;&lt;&lt;latLonH(0)*180/M_PI&lt;&lt;&quot; &quot;&lt;&lt;latLonH(1)*180/M_PI&lt;&lt;&quot; &quot;&lt;&lt;latLonH(2)&lt;&lt;std::endl;</span>
<a name="l00390"></a>00390                 <span class="comment">//std::cout&lt;&lt;&quot;Vel GpsUpdate: &quot;&lt;&lt;vn&lt;&lt;std::endl;</span>
<a name="l00391"></a>00391                 <span class="comment">//std::cout&lt;&lt;&quot;Att GpsUpdate: &quot;&lt;&lt;quat2Euler(q)*180/M_PI&lt;&lt;std::endl;</span>
<a name="l00392"></a>00392     }
<a name="l00393"></a><a class="code" href="classmavsim_1_1_gps_ins.html#a5bd3ad24c5559419e3db1764a99002cc">00393</a> }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="keywordtype">void</span> <a class="code" href="classmavsim_1_1_gps_ins.html#a5bd3ad24c5559419e3db1764a99002cc">GpsIns::getState</a>(<span class="keywordtype">double</span> *output)
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397         vector&lt;double&gt; eulerTemp = <a class="code" href="namespacemavsim.html#afbb2ecc964ed93b48de512bf6ddcf79f">quat2Euler</a>(<a class="code" href="classmavsim_1_1_gps_ins.html#a5ec0d32c684e7982ed2ff6426d22774f">q</a>)*180/M_PI;
<a name="l00398"></a>00398         output[0]=<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(0);
<a name="l00399"></a>00399         output[1]=<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(1);
<a name="l00400"></a>00400         output[2]=<a class="code" href="classmavsim_1_1_gps_ins.html#a0f3fabb1b68a9c80c1e05f9adba6abc2">latLonH</a>(2);
<a name="l00401"></a>00401         output[3]=eulerTemp(0);
<a name="l00402"></a>00402         output[4]=eulerTemp(1);
<a name="l00403"></a>00403         output[5]=eulerTemp(2);
<a name="l00404"></a>00404         output[6]=<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(0);
<a name="l00405"></a>00405         output[7]=<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(1);
<a name="l00406"></a>00406         output[8]=<a class="code" href="classmavsim_1_1_gps_ins.html#ad45eed037ffc4f848e23e525d740ffaf">vn</a>(2);
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 } <span class="comment">// mavsim</span>
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="comment">// vim:ts=4:sw=4</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 9 2011 05:50:17 for mavsim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
